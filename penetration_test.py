import json
import subprocess

# Funkce pro spuštění WPScan s cílovou URL
def run_wpscan(target_url):
    try:
        # Spuštění WPScan s cílovou URL
        cmd = f"sudo wpscan --url {target_url} --enumerate u,vp,vt,tt,cb,dbe,u,m --no-update --json"
        result = subprocess.check_output(cmd, shell=True, stderr=subprocess.STDOUT)
        return result.decode("utf-8")

    except subprocess.CalledProcessError as e:
        return json.dumps({"error": str(e)}, indent=4)

if __name__ == "__main__":
    try:
        # Získání dat z PHP skriptu
        data_json = input()
        data = json.loads(data_json)

        # Získání cílové URL
        target_url = data.get("target_url")

        # Spuštění WPScan a získání výsledků
        wpscan_results = run_wpscan(target_url)

        # Vrácení výsledků do PHP skriptu
        print(wpscan_results)

    except Exception as e:
        print(str(e))
